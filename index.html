<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shay Analytics AI</title>
  <link rel="stylesheet" href="./styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;600;700&family=Fraunces:wght@600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <main id="landingView">
    <header class="landing-header">
      <div class="brand">
        <div class="logo">SA</div>
        <div>
          <h1>Shay Analytics AI</h1>
          <p>Turn raw data into executive-ready dashboards in minutes.</p>
        </div>
      </div>
      <button id="signInBtn" class="ghost">Sign In</button>
    </header>

    <section class="hero">
      <span class="pill">New: AI Powered Insights</span>
      <h2>Turn Raw Data into Beautiful Insights</h2>
      <p>Upload a CSV, connect an API, or pull from Google Sheets to get KPI tiles, trends, and clean data tables instantly.</p>
      <div class="hero-actions">
        <button id="startFreeBtn" class="primary">Start for Free</button>
        <button class="ghost" disabled title="Coming soon">Learn more</button>
      </div>
      <p id="webhookStatus" class="helper-text">Webhook status: checking...</p>
    </section>

  </main>

  <main id="appView" class="hidden">
    <header class="app-header">
      <div class="brand">
        <div class="logo">SA</div>
        <div>
          <h1>Shay Analytics AI</h1>
          <p>Upload, connect, and explore your data.</p>
        </div>
      </div>
      <div class="app-header-actions">
        <div class="tabs header-tabs">
          <button class="tab-button active" data-tab="upload">Upload CSV</button>
          <button class="tab-button" data-tab="api">Connect API</button>
          <button class="tab-button" data-tab="pdf">Upload PDF</button>
          <button class="tab-button" data-tab="sheets">Google Sheets</button>
          <button class="tab-button" data-tab="samples">Samples</button>
        </div>
        <button id="signOutButton" class="ghost">Sign out</button>
      </div>
    </header>

    <main class="container">
      <section id="status" class="status hidden"></section>
      <section id="error" class="error hidden"></section>
      <section id="warnings" class="warnings hidden"></section>

      <section id="state" class="state tab-panel" data-tab-panel="upload">
        <div class="upload-panel">
          <div class="drop-zone" id="dropZone">
            <p>Drag and drop a CSV here</p>
            <button id="uploadTrigger" class="ghost">Choose file</button>
            <input type="file" id="uploadInput" accept=".csv,text/csv" />
          </div>
          <div class="upload-help">
            <p>Supported: CSV with headers. We handle currency symbols, percent values, and thousands separators.</p>
          </div>
        </div>
        <div class="state-card">
          <h2>Get started</h2>
          <p>Upload a CSV file to generate KPIs, charts, and a data table. Your data never leaves the browser.</p>
          <ul class="state-list">
            <li>Auto-detects numeric metrics</li>
            <li>Finds date columns for trends</li>
            <li>Profiles data quality before analysis</li>
          </ul>
        </div>
      </section>

      <section id="apiPanel" class="tab-panel hidden" data-tab-panel="api">
        <div class="table-card">
          <div class="table-header">
            <h3>Connect API</h3>
            <p>Provide the endpoint details. We will validate inputs in a future release.</p>
          </div>
          <div class="api-form">
            <label>Base URL <input type="text" id="apiBaseUrl" placeholder="https://api.example.com" /></label>
            <label>Auth type
              <select id="apiAuthType">
                <option value="none">None</option>
                <option value="apiKey">API Key</option>
                <option value="bearer">Bearer Token</option>
              </select>
            </label>
            <label>Credential <input type="password" id="apiKey" placeholder="••••••••" /></label>
            <label>Endpoint <input type="text" id="apiEndpoint" placeholder="/v1/data" /></label>
            <button id="testApi" class="ghost" disabled title="Coming soon">Test Connection</button>
            <p id="apiStatus" class="helper-text">Coming soon</p>
          </div>
        </div>
      </section>

      <section id="pdfPanel" class="tab-panel hidden" data-tab-panel="pdf">
        <div class="table-card">
          <div class="table-header">
            <h3>Upload PDF</h3>
            <p>Upload a PDF that contains a clear, table-like layout. We will extract the first 6 pages.</p>
          </div>
          <div class="api-form">
            <label>PDF file
              <input type="file" id="pdfInput" accept="application/pdf" />
            </label>
            <div id="pdfStatus" class="helper-text">PDFs must include visible table rows and columns.</div>
            <div id="pdfMeta" class="helper-text"></div>
          </div>
        </div>
      </section>

      <section id="sheetsPanel" class="tab-panel hidden" data-tab-panel="sheets">
        <div class="table-card">
          <div class="table-header">
            <h3>Google Sheets</h3>
            <p>Paste a Google Sheets link. Private sheets require Google connect.</p>
          </div>
          <div class="api-form">
            <label>Paste Google Sheets CSV link
              <input type="text" id="sheetsUrl" placeholder="https://docs.google.com/spreadsheets/.../export?format=csv" />
            </label>
            <label>Range (optional)
              <input type="text" id="sheetsRange" placeholder="Sheet1!A1:Z1000" />
            </label>
            <div class="sheets-actions">
              <button id="loadSheet" class="ghost">Load sheet</button>
              <button id="connectGoogle" class="ghost">Connect Google</button>
              <button id="disconnectGoogle" class="ghost" disabled>Disconnect</button>
              <span id="googleStatus" class="helper-text">Not connected</span>
            </div>
            <p id="sheetsHelper" class="helper-text">Paste a Google Sheets link. If it is an edit link, the app will convert it to a CSV export link.</p>
          </div>
        </div>
      </section>

      <section id="samplesPanel" class="tab-panel hidden" data-tab-panel="samples">
        <div class="table-card">
          <div class="table-header">
            <h3>Samples</h3>
            <p>Pick a curated dataset to preview KPIs and trends.</p>
          </div>
          <div id="sampleGallery" class="sample-grid"></div>
          <div class="suggested-trends">
            <h4>Suggested trends</h4>
            <ul id="suggestedTrends"></ul>
          </div>
        </div>
      </section>

      <section id="dashboard" class="dashboard hidden">
        <div class="demo-banner">Demo dataset. No client data.</div>
        <div class="section-header">
          <div class="section-title">
            <h2>Dashboard</h2>
            <span id="qualityBadge" class="quality-badge">Quality —</span>
          </div>
          <p id="datasetSummary"></p>
        </div>

        <section class="kpi-grid" id="kpiGrid"></section>

        <section class="controls-panel">
          <div class="control-group">
            <label for="industrySelect">Industry</label>
            <select id="industrySelect" disabled>
              <option value="All">All</option>
            </select>
            <span id="industryHelper" class="helper-text"></span>
          </div>
          <div class="control-group">
            <label for="metricSelect">Primary metric</label>
            <select id="metricSelect"></select>
          </div>
          <div class="control-group">
            <label for="dimensionSelect">Breakdown dimension</label>
            <select id="dimensionSelect"></select>
          </div>
          <div class="control-group">
            <label for="topN">Top N</label>
            <select id="topN">
              <option value="5">5</option>
              <option value="8" selected>8</option>
              <option value="12">12</option>
            </select>
          </div>
          <div class="control-group">
            <label for="domainSelect">Domain</label>
            <select id="domainSelect">
              <option value="auto" selected>Auto-detect</option>
              <option value="finance">Finance</option>
              <option value="marketing">Marketing</option>
              <option value="product">Product</option>
              <option value="operations">Operations</option>
              <option value="general">General</option>
            </select>
          </div>
          <div class="control-group">
            <label for="dateStart">Date start</label>
            <input type="date" id="dateStart" />
          </div>
          <div class="control-group">
            <label for="dateEnd">Date end</label>
            <input type="date" id="dateEnd" />
          </div>
          <div class="control-group control-actions">
            <label>Actions</label>
            <div class="control-buttons">
              <button id="exportCsv" class="ghost">Export filtered CSV</button>
              <button id="downloadInsights" class="ghost">Download insights</button>
              <button id="exportSheets" class="ghost">Export to Google Sheets</button>
              <button id="downloadPdf" class="ghost">Download PDF</button>
            </div>
            <p id="exportStatus" class="helper-text"></p>
          </div>
        </section>

        <section class="charts">
          <div class="filter-badge" id="filterBadge">Filtered to: All</div>
          <div class="chart-card">
            <div class="chart-header">
              <h3 id="trendTitle">Trend</h3>
              <p id="trendSubtitle"></p>
            </div>
            <canvas id="trendChart" height="140"></canvas>
          </div>
          <div class="chart-card">
            <div class="chart-header">
              <h3 id="barTitle">Breakdown</h3>
              <p id="barSubtitle"></p>
            </div>
            <canvas id="barChart" height="140"></canvas>
          </div>
          <div class="chart-card">
            <div class="chart-header">
              <h3 id="extraTitle">Analysis</h3>
              <p id="extraSubtitle"></p>
            </div>
            <canvas id="extraChart" height="140"></canvas>
          </div>
        </section>

        <section class="heatmap-card" id="comparisonSection">
          <div class="chart-header">
            <h3>Metric Comparison</h3>
            <p>Pick a primary metric and compare drivers, trends, and segments.</p>
            <p id="comparisonNote" class="helper-text"></p>
          </div>
          <div class="comparison-controls">
            <div class="control-group">
              <label for="primaryMetricSelect">Primary Metric</label>
              <select id="primaryMetricSelect"></select>
            </div>
            <div class="control-group">
              <label for="compareMetricSelect">Compare Against (up to 5)</label>
              <select id="compareMetricSelect" multiple size="4"></select>
            </div>
          </div>
          <div class="heatmap-wrapper">
            <canvas id="comparisonTrendChart"></canvas>
          </div>
          <div class="comparison-grid">
            <div class="comparison-card">
              <h4>Drivers and relationships</h4>
              <ul id="driversList"></ul>
            </div>
            <div class="comparison-card">
              <h4>Segment view</h4>
              <div class="heatmap-wrapper small">
                <canvas id="segmentChart"></canvas>
              </div>
            </div>
          </div>
        </section>

        <section class="insights-card">
          <div class="chart-header">
            <h3>Insights</h3>
            <p>What changed, what stands out, and where to look next.</p>
          </div>
          <ul id="insightsList"></ul>
        </section>

        <section class="table-card">
          <div class="table-header">
            <h3>Data Profile</h3>
            <p>Column schema, quality, and quick stats.</p>
          </div>
          <div class="table-wrap">
            <table id="profileTable"></table>
          </div>
        </section>

        <section class="table-card">
          <div class="table-header">
            <h3>Data Preview</h3>
            <p>Click any column to sort. Showing up to 50 rows.</p>
          </div>
          <div class="table-wrap">
            <table id="dataTable"></table>
          </div>
        </section>
      </section>
    </main>
  </main>

  <footer class="site-footer">
    <p>Built with plain HTML, CSS, JavaScript, PapaParse, and Chart.js. <span id="buildStamp"></span></p>
  </footer>

  <div id="signupModal" class="modal hidden" aria-hidden="true">
    <div class="modal-card">
      <button id="closeModal" class="modal-close">×</button>
      <h3>Start for Free</h3>
      <p class="helper-text">Create your account to unlock the dashboard.</p>
      <form id="signupForm" class="modal-form">
        <label>Full name
          <input type="text" id="signupName" required />
        </label>
        <label>Email
          <input type="email" id="signupEmail" required />
        </label>
        <label>Company (optional)
          <input type="text" id="signupCompany" />
        </label>
        <label>Use case (optional)
          <select id="signupUseCase">
            <option value="">Select one</option>
            <option value="Executive dashboards">Executive dashboards</option>
            <option value="Marketing reporting">Marketing reporting</option>
            <option value="Product analytics">Product analytics</option>
            <option value="Operations">Operations</option>
            <option value="Other">Other</option>
          </select>
        </label>
        <button id="signupSubmit" type="submit" class="primary">Create account</button>
      </form>
      <p id="formError" class="error hidden"></p>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1.3.0/dist/chartjs-chart-matrix.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="./app.js" defer></script>
</body>
</html>
